# Specification by Example (SBE) - Tetris Battle

‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö (Behavior) ‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Test (TDD) ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö

## üéÆ 1. Core Gameplay Mechanics

### Scenario 1.1: Basic Line Clear
**Given** ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏°‡∏µ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏ñ‡∏ß‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î 1 ‡πÅ‡∏ñ‡∏ß (‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 20)
**When** ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ß‡∏≤‡∏á‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô `I-Piece` ‡∏•‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
**Then**
1. ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 20 ‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å
2. ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 20 ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏Å‡∏•‡∏á‡∏°‡∏≤ 1 ‡∏ä‡πà‡∏≠‡∏á
3. ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô (‡∏ï‡∏≤‡∏°‡∏Å‡∏é Score Table)

### Scenario 1.2: Game Over Condition
**Given** ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏°‡∏µ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏≠‡∏á‡∏™‡∏π‡∏á‡∏ñ‡∏∂‡∏á‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 1 (Top out zone)
**When** ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ß‡∏≤‡∏á‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà ‡∏ì ‡∏à‡∏∏‡∏î‡πÄ‡∏Å‡∏¥‡∏î (Spawn Point)
**Then**
1. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Å‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô `GAME_OVER`
2. ‡∏≠‡∏¥‡∏ô‡∏û‡∏∏‡∏ï‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏≠‡∏µ‡∏Å

### Scenario 1.3: Wall Kick (SRS - Super Rotation System)
**Given** ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô `T-Piece` ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏¥‡∏î‡∏ú‡∏ô‡∏±‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤
**When** ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏î‡∏´‡∏°‡∏∏‡∏ô‡∏Ç‡∏ß‡∏≤ (Rotate Clockwise)
**Then**
1. ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏∞‡∏•‡∏∏‡∏ú‡∏ô‡∏±‡∏á
2. ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏¢‡∏±‡∏ö‡∏ã‡πâ‡∏≤‡∏¢ 1 ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏ï‡∏≤‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á SRS Wall Kick)

---

## ‚öîÔ∏è 2. Multiplayer Mechanics

### Scenario 2.1: Sending Garbage
**Given** ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô A ‡πÅ‡∏•‡∏∞ B ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
**When** ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô A ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡πÑ‡∏î‡πâ 4 ‡πÅ‡∏ñ‡∏ß‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô (Tetris)
**Then**
1. ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô A ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Back-to-Back (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
2. ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô B ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö Garbage Lines ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 4 ‡πÅ‡∏ñ‡∏ß ‡πÉ‡∏ô‡∏Ñ‡∏¥‡∏ß (Pending Garbage)
3. Garbage Lines ‡∏à‡∏∞‡∏î‡∏±‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô B ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô B ‡∏ß‡∏≤‡∏á‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ

### Scenario 2.2: Winning the Match
**Given** ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô A ‡πÅ‡∏•‡∏∞ B ‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏Å‡∏±‡∏ô
**When** ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô B ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ `GAME_OVER`
**Then**
1. ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô A ‡∏ä‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (Status: `WINNER`)
2. ‡πÄ‡∏Å‡∏°‡∏´‡∏¢‡∏∏‡∏î‡∏•‡∏á
3. ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•

---

## üïπÔ∏è 3. Input Handling (Advanced)

### Scenario 3.1: DAS (Delayed Auto Shift)
**Given** ‡∏Ñ‡πà‡∏≤ DAS = 150ms, ARR = 30ms
**When** ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° `RIGHT` ‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ
**Then**
1. ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏¢‡∏±‡∏ö‡∏Ç‡∏ß‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
2. ‡∏£‡∏≠‡πÄ‡∏ß‡∏•‡∏≤ 150ms (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏±‡∏ö)
3. ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏¢‡∏±‡∏ö‡∏Ç‡∏ß‡∏≤‡∏ó‡∏∏‡∏Å‡πÜ 30ms ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏ô‡∏Ç‡∏≠‡∏ö

---

## üß™ TDD Checklist (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
- [ ] `Core.test.ts`: Test Line Clear logic with mock board data.
- [ ] `Core.test.ts`: Test Wall Kick cases (T-Spin, I-Spin).
- [ ] `Network.test.ts`: Test Garbage Queue sync between mocks.
